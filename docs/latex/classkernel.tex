\hypertarget{classkernel}{}\doxysection{kernel$<$ n, d $>$ Class Template Reference}
\label{classkernel}\index{kernel$<$ n, d $>$@{kernel$<$ n, d $>$}}


{\ttfamily \#include $<$kde.\+hpp$>$}

\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classkernel_a4e3c9e3e807c993f1bdb7d830b8c161c}{kernel}} ()
\item 
\mbox{\hyperlink{classkernel_a2acadb01ec81bd2c00bd51129e497731}{kernel}} (const Vector \&bandwidth)
\item 
void \mbox{\hyperlink{classkernel_a29719a1ad1e05eeef8f2af393c1be8f4}{fit}} (const data\+Matrix \&data)
\item 
double \mbox{\hyperlink{classkernel_adc2e408be8846dabe4ff0682380cbb0e}{evaluate}} (const Vector \&x)
\item 
void \mbox{\hyperlink{classkernel_a9aa08b4bbbff1e7cad3eb8d2df2c953f}{set\+\_\+bandwidth}} (const Vector \&bandwidth)
\item 
void \mbox{\hyperlink{classkernel_a71a37b33c06a051a21b519b575313b31}{find\+\_\+optimal\+\_\+bandwidth}} (std\+::string \mbox{\hyperlink{quadratic__cons_8cpp_a6443366162227f24729c69d1c6b31a0b}{method}})
\item 
double \mbox{\hyperlink{classkernel_a38ac47f44d80610c99825c0018e989b3}{silverman}} ()
\item 
double \mbox{\hyperlink{classkernel_a570a268aa95e743b510ce4912a9c32aa}{scott}} ()
\item 
void \mbox{\hyperlink{classkernel_a1d07fe4d705b18443216edfc5c0feb2a}{add\+\_\+data}} (const std\+::vector$<$ double $>$ data, const std\+::size\+\_\+t i)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\subsubsection*{template$<$std\+::size\+\_\+t n, std\+::size\+\_\+t d$>$\newline
class kernel$<$ n, d $>$}


Definition at line 14 of file kde.\+hpp.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classkernel_a4e3c9e3e807c993f1bdb7d830b8c161c}\label{classkernel_a4e3c9e3e807c993f1bdb7d830b8c161c}} 
\index{kernel$<$ n, d $>$@{kernel$<$ n, d $>$}!kernel@{kernel}}
\index{kernel@{kernel}!kernel$<$ n, d $>$@{kernel$<$ n, d $>$}}
\doxysubsubsection{\texorpdfstring{kernel()}{kernel()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$std\+::size\+\_\+t n, std\+::size\+\_\+t d$>$ \\
\mbox{\hyperlink{classkernel}{kernel}}$<$ \mbox{\hyperlink{quadratic__cons_8cpp_a0ada73864feca33d57698f2c4603f1fb}{n}}, \mbox{\hyperlink{metrics_8hpp_a752fb3bdbe85697907a35af83f1679cf}{d}} $>$\+::\mbox{\hyperlink{classkernel}{kernel}}}



Definition at line 48 of file kde.\+hpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{48 \{\}}

\end{DoxyCode}
\mbox{\Hypertarget{classkernel_a2acadb01ec81bd2c00bd51129e497731}\label{classkernel_a2acadb01ec81bd2c00bd51129e497731}} 
\index{kernel$<$ n, d $>$@{kernel$<$ n, d $>$}!kernel@{kernel}}
\index{kernel@{kernel}!kernel$<$ n, d $>$@{kernel$<$ n, d $>$}}
\doxysubsubsection{\texorpdfstring{kernel()}{kernel()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$std\+::size\+\_\+t n, std\+::size\+\_\+t d$>$ \\
\mbox{\hyperlink{classkernel}{kernel}}$<$ \mbox{\hyperlink{quadratic__cons_8cpp_a0ada73864feca33d57698f2c4603f1fb}{n}}, \mbox{\hyperlink{metrics_8hpp_a752fb3bdbe85697907a35af83f1679cf}{d}} $>$\+::\mbox{\hyperlink{classkernel}{kernel}} (\begin{DoxyParamCaption}\item[{const Vector \&}]{bandwidth }\end{DoxyParamCaption})}



Definition at line 52 of file kde.\+hpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{53 \{}
\DoxyCodeLine{54     this-\/>\mbox{\hyperlink{classkernel_a9aa08b4bbbff1e7cad3eb8d2df2c953f}{set\_bandwidth}}(bandwidth);  }
\DoxyCodeLine{55 \} }

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classkernel_a1d07fe4d705b18443216edfc5c0feb2a}\label{classkernel_a1d07fe4d705b18443216edfc5c0feb2a}} 
\index{kernel$<$ n, d $>$@{kernel$<$ n, d $>$}!add\_data@{add\_data}}
\index{add\_data@{add\_data}!kernel$<$ n, d $>$@{kernel$<$ n, d $>$}}
\doxysubsubsection{\texorpdfstring{add\_data()}{add\_data()}}
{\footnotesize\ttfamily template$<$std\+::size\+\_\+t n, std\+::size\+\_\+t d$>$ \\
void \mbox{\hyperlink{classkernel}{kernel}}$<$ \mbox{\hyperlink{quadratic__cons_8cpp_a0ada73864feca33d57698f2c4603f1fb}{n}}, \mbox{\hyperlink{metrics_8hpp_a752fb3bdbe85697907a35af83f1679cf}{d}} $>$\+::add\+\_\+data (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ double $>$}]{data,  }\item[{const std\+::size\+\_\+t}]{i }\end{DoxyParamCaption})}



Definition at line 64 of file kde.\+hpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{65 \{}
\DoxyCodeLine{66     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0; j<\mbox{\hyperlink{metrics_8hpp_a752fb3bdbe85697907a35af83f1679cf}{d}}; j++)}
\DoxyCodeLine{67     \{}
\DoxyCodeLine{68         data\_(i,j) = data[j];}
\DoxyCodeLine{69     \};}
\DoxyCodeLine{70 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classkernel_adc2e408be8846dabe4ff0682380cbb0e}\label{classkernel_adc2e408be8846dabe4ff0682380cbb0e}} 
\index{kernel$<$ n, d $>$@{kernel$<$ n, d $>$}!evaluate@{evaluate}}
\index{evaluate@{evaluate}!kernel$<$ n, d $>$@{kernel$<$ n, d $>$}}
\doxysubsubsection{\texorpdfstring{evaluate()}{evaluate()}}
{\footnotesize\ttfamily template$<$std\+::size\+\_\+t n, std\+::size\+\_\+t d$>$ \\
double \mbox{\hyperlink{classkernel}{kernel}}$<$ \mbox{\hyperlink{quadratic__cons_8cpp_a0ada73864feca33d57698f2c4603f1fb}{n}}, \mbox{\hyperlink{metrics_8hpp_a752fb3bdbe85697907a35af83f1679cf}{d}} $>$\+::evaluate (\begin{DoxyParamCaption}\item[{const Vector \&}]{x }\end{DoxyParamCaption})}



Definition at line 73 of file kde.\+hpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{74 \{}
\DoxyCodeLine{75     \textcolor{keywordtype}{double} prob;}
\DoxyCodeLine{76 \textcolor{comment}{/*    std::cout << "{}data\_: \(\backslash\)n"{} << data\_ << std::endl;}}
\DoxyCodeLine{77 \textcolor{comment}{    std::cout << "{}x: \(\backslash\)n"{} << x << std::endl;}}
\DoxyCodeLine{78 \textcolor{comment}{    std::cout << "{}data\_ -\/ x.transpose().repliacete(n,1): \(\backslash\)n"{} << data\_ -\/ x.transpose().replicate(n,1) <<std::endl;}}
\DoxyCodeLine{79 \textcolor{comment}{    std::cout << "{}bandwidth transpose replicate: \(\backslash\)n"{} << bandwidth\_.transpose().replicate(n,1)<<std::endl;}}
\DoxyCodeLine{80 \textcolor{comment}{  */}  distances\_ = (data\_-\/ x.transpose().replicate(\mbox{\hyperlink{linear__cons_8cpp_a0ada73864feca33d57698f2c4603f1fb}{n}},1)).cwiseProduct(bandwidth\_.transpose().replicate(\mbox{\hyperlink{linear__cons_8cpp_a0ada73864feca33d57698f2c4603f1fb}{n}},1));}
\DoxyCodeLine{81     \textcolor{comment}{/*std::cout << "{}d-\/x.t*b"{} << distances\_ << std::endl;}}
\DoxyCodeLine{82 \textcolor{comment}{    std::cout << "{}>1: "{} << distances\_ << std::endl;}}
\DoxyCodeLine{83 \textcolor{comment}{    */}distances\_ = (distances\_.array().abs() > 1.0).select(1, distances\_);  \textcolor{comment}{// select(1 instead of 0 -\/> }}
\DoxyCodeLine{84     distances\_ = 3./4. *( 1.0 -\/ distances\_.array().square()); \textcolor{comment}{// for all vals > 0 follows that distances = 0 because 1-\/1}}
\DoxyCodeLine{85     \textcolor{comment}{/*std::cout << "{}distances\_ : "{} << distances\_ << std::endl;}}
\DoxyCodeLine{86 \textcolor{comment}{    std::cout << "{}distances\_ filter: "{} << distances\_ << std::endl;}}
\DoxyCodeLine{87 \textcolor{comment}{   */} prob = distances\_.rowwise().prod().sum()*nh\_; }
\DoxyCodeLine{88    \textcolor{comment}{// std::cout << "{}dist prod:"{} << distances\_.rowwise().prod() << std::endl; }}
\DoxyCodeLine{89     \textcolor{keywordflow}{return} prob;}
\DoxyCodeLine{90 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classkernel_a71a37b33c06a051a21b519b575313b31}\label{classkernel_a71a37b33c06a051a21b519b575313b31}} 
\index{kernel$<$ n, d $>$@{kernel$<$ n, d $>$}!find\_optimal\_bandwidth@{find\_optimal\_bandwidth}}
\index{find\_optimal\_bandwidth@{find\_optimal\_bandwidth}!kernel$<$ n, d $>$@{kernel$<$ n, d $>$}}
\doxysubsubsection{\texorpdfstring{find\_optimal\_bandwidth()}{find\_optimal\_bandwidth()}}
{\footnotesize\ttfamily template$<$std\+::size\+\_\+t n, std\+::size\+\_\+t d$>$ \\
void \mbox{\hyperlink{classkernel}{kernel}}$<$ \mbox{\hyperlink{quadratic__cons_8cpp_a0ada73864feca33d57698f2c4603f1fb}{n}}, \mbox{\hyperlink{metrics_8hpp_a752fb3bdbe85697907a35af83f1679cf}{d}} $>$\+::find\+\_\+optimal\+\_\+bandwidth (\begin{DoxyParamCaption}\item[{std\+::string}]{method }\end{DoxyParamCaption})}



Definition at line 133 of file kde.\+hpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{134 \{}
\DoxyCodeLine{135     \textcolor{keywordtype}{double} C;}
\DoxyCodeLine{136     assert (\mbox{\hyperlink{linear__cons_8cpp_a6443366162227f24729c69d1c6b31a0b}{method}} == \textcolor{stringliteral}{"{}scott"{}} || \mbox{\hyperlink{linear__cons_8cpp_a6443366162227f24729c69d1c6b31a0b}{method}} == \textcolor{stringliteral}{"{}silverman"{}});}
\DoxyCodeLine{137     \textcolor{keywordflow}{if} (\mbox{\hyperlink{linear__cons_8cpp_a6443366162227f24729c69d1c6b31a0b}{method}} == \textcolor{stringliteral}{"{}scott"{}}) C = this-\/>\mbox{\hyperlink{classkernel_a570a268aa95e743b510ce4912a9c32aa}{scott}}();}
\DoxyCodeLine{138     \textcolor{keywordflow}{else} C = this-\/>\mbox{\hyperlink{classkernel_a38ac47f44d80610c99825c0018e989b3}{silverman}}();}
\DoxyCodeLine{139     bandwidth\_ = C*((data\_.rowwise() -\/ data\_.colwise().mean()).array().square().colwise().sum() / (n\_-\/1.)).sqrt();}
\DoxyCodeLine{140     std::cout << \textcolor{stringliteral}{"{}bandwidth:"{}} << bandwidth\_.array().pow(-\/1) << std::endl;}
\DoxyCodeLine{141     this-\/>\mbox{\hyperlink{classkernel_a9aa08b4bbbff1e7cad3eb8d2df2c953f}{set\_bandwidth}}(bandwidth\_.array().pow(-\/1)) ;}
\DoxyCodeLine{142     \textcolor{comment}{//this-\/>set\_bandwidth(bandwidth\_) ;}}
\DoxyCodeLine{143 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classkernel_a29719a1ad1e05eeef8f2af393c1be8f4}\label{classkernel_a29719a1ad1e05eeef8f2af393c1be8f4}} 
\index{kernel$<$ n, d $>$@{kernel$<$ n, d $>$}!fit@{fit}}
\index{fit@{fit}!kernel$<$ n, d $>$@{kernel$<$ n, d $>$}}
\doxysubsubsection{\texorpdfstring{fit()}{fit()}}
{\footnotesize\ttfamily template$<$std\+::size\+\_\+t n, std\+::size\+\_\+t d$>$ \\
void \mbox{\hyperlink{classkernel}{kernel}}$<$ \mbox{\hyperlink{quadratic__cons_8cpp_a0ada73864feca33d57698f2c4603f1fb}{n}}, \mbox{\hyperlink{metrics_8hpp_a752fb3bdbe85697907a35af83f1679cf}{d}} $>$\+::fit (\begin{DoxyParamCaption}\item[{const data\+Matrix \&}]{data }\end{DoxyParamCaption})}



Definition at line 58 of file kde.\+hpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{59 \{}
\DoxyCodeLine{60     data\_ = data;}
\DoxyCodeLine{61 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classkernel_a570a268aa95e743b510ce4912a9c32aa}\label{classkernel_a570a268aa95e743b510ce4912a9c32aa}} 
\index{kernel$<$ n, d $>$@{kernel$<$ n, d $>$}!scott@{scott}}
\index{scott@{scott}!kernel$<$ n, d $>$@{kernel$<$ n, d $>$}}
\doxysubsubsection{\texorpdfstring{scott()}{scott()}}
{\footnotesize\ttfamily template$<$std\+::size\+\_\+t n, std\+::size\+\_\+t d$>$ \\
double \mbox{\hyperlink{classkernel}{kernel}}$<$ \mbox{\hyperlink{quadratic__cons_8cpp_a0ada73864feca33d57698f2c4603f1fb}{n}}, \mbox{\hyperlink{metrics_8hpp_a752fb3bdbe85697907a35af83f1679cf}{d}} $>$\+::scott}



Definition at line 127 of file kde.\+hpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{128 \{}
\DoxyCodeLine{129     \textcolor{keywordflow}{return} pow(n\_,-\/1./(d\_+4.));}
\DoxyCodeLine{130 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classkernel_a9aa08b4bbbff1e7cad3eb8d2df2c953f}\label{classkernel_a9aa08b4bbbff1e7cad3eb8d2df2c953f}} 
\index{kernel$<$ n, d $>$@{kernel$<$ n, d $>$}!set\_bandwidth@{set\_bandwidth}}
\index{set\_bandwidth@{set\_bandwidth}!kernel$<$ n, d $>$@{kernel$<$ n, d $>$}}
\doxysubsubsection{\texorpdfstring{set\_bandwidth()}{set\_bandwidth()}}
{\footnotesize\ttfamily template$<$std\+::size\+\_\+t n, std\+::size\+\_\+t d$>$ \\
void \mbox{\hyperlink{classkernel}{kernel}}$<$ \mbox{\hyperlink{quadratic__cons_8cpp_a0ada73864feca33d57698f2c4603f1fb}{n}}, \mbox{\hyperlink{metrics_8hpp_a752fb3bdbe85697907a35af83f1679cf}{d}} $>$\+::set\+\_\+bandwidth (\begin{DoxyParamCaption}\item[{const Vector \&}]{bandwidth }\end{DoxyParamCaption})}



Definition at line 93 of file kde.\+hpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{94 \{}
\DoxyCodeLine{95    bandwidth\_ = bandwidth; }
\DoxyCodeLine{96    nh\_ = bandwidth.prod()/n\_;}
\DoxyCodeLine{97 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classkernel_a38ac47f44d80610c99825c0018e989b3}\label{classkernel_a38ac47f44d80610c99825c0018e989b3}} 
\index{kernel$<$ n, d $>$@{kernel$<$ n, d $>$}!silverman@{silverman}}
\index{silverman@{silverman}!kernel$<$ n, d $>$@{kernel$<$ n, d $>$}}
\doxysubsubsection{\texorpdfstring{silverman()}{silverman()}}
{\footnotesize\ttfamily template$<$std\+::size\+\_\+t n, std\+::size\+\_\+t d$>$ \\
double \mbox{\hyperlink{classkernel}{kernel}}$<$ \mbox{\hyperlink{quadratic__cons_8cpp_a0ada73864feca33d57698f2c4603f1fb}{n}}, \mbox{\hyperlink{metrics_8hpp_a752fb3bdbe85697907a35af83f1679cf}{d}} $>$\+::silverman}



Definition at line 121 of file kde.\+hpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{122 \{}
\DoxyCodeLine{123     \textcolor{keywordflow}{return} pow(4./(d\_+2.),(1./(d\_+4)))*pow(n\_,-\/1./(\mbox{\hyperlink{metrics_8hpp_a752fb3bdbe85697907a35af83f1679cf}{d}}+4.));}
\DoxyCodeLine{124 \}}

\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
src/\mbox{\hyperlink{kde_8hpp}{kde.\+hpp}}\end{DoxyCompactItemize}
